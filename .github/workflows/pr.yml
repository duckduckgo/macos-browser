name: PR Checks

on: 
  push:
    branches: [ develop, "release/**" ]
  pull_request:


jobs:
  swiftlint:

    name: SwiftLint

    if: github.event_name == 'pull_request'

    runs-on: ubuntu-latest

    steps:
    - name: Check out the code
      uses: actions/checkout@v3

    - name: Run SwiftLint on files changed in the PR
      uses: norio-nomura/action-swiftlint@3.2.1
      with:
        args: --strict --force-exclude
        
  asana:
    name: Create Asana Task
    runs-on: ubuntu-latest

    steps:
      - uses: malmstein/github-asana-action@master
        with:
          asana-pat: ${{ secrets.ASANA_ACCESS_TOKEN }}
          asana-project: '1201037661562251'
          asana-task-name: 'PR Checks failed on develop'
          action: create-asana-task
          asana-task-description: Tests after merging have failed. See https://github.com/duckduckgo/macos-browser/actions/runs/${{ github.run_id }}